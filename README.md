# Video Model Benchmark

## Environments

* CUDA Toolkit 10.1
* CuDNN 7.6.2

Install dependencies for [SlowFast](https://github.com/facebookresearch/SlowFast). Then create link by

```
ln -s SlowFast/slowfast ./slowfast
```

## Getting started

Profile by running

```
python main.py --model i3d
```

## Example output

```
Profile model i3d

Params: 28,043,472
GPU Mem: 0.10470056533813477 MB
FLOPs: 56.814501888 GFLOPs

Module                | Self CPU total | CPU total | CUDA total | Occurrences
----------------------|----------------|-----------|------------|------------
ResNet                |                |           |            |            
├── s1                |                |           |            |            
│├── pathway0_stem    |                |           |            |            
││├── conv            |        1.448ms |   5.687ms |  102.623ms |           1
││├── bn              |        1.314ms |   3.763ms |   10.265ms |           1
││├── relu            |       48.309us |  48.309us |    1.073ms |           1
││└── pool_layer      |        1.579ms |   3.144ms |    4.938ms |           1
├── s2                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |        2.485ms |   9.860ms |   21.154ms |           1
││├── branch1_bn      |        1.276ms |   3.681ms |    8.273ms |           1
││├── branch2         |                |           |            |            
│││├── a              |        3.717ms |  14.793ms |   21.216ms |           1
│││├── a_bn           |      918.757us |   2.617ms |    4.224ms |           1
│││├── a_relu         |       39.140us |  39.140us |  287.744us |           1
│││├── b              |      854.226us |   3.344ms |   14.668ms |           1
│││├── b_bn           |      937.090us |   2.671ms |    4.274ms |           1
│││├── b_relu         |       40.520us |  40.520us |  287.776us |           1
│││├── c              |        2.563ms |  10.180ms |   21.520ms |           1
│││└── c_bn           |        1.863ms |   5.448ms |   10.022ms |           1
││└── relu            |       38.224us |  38.224us |    1.065ms |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      135.264us | 467.923us |   26.234ms |           1
│││├── a_bn           |      187.578us | 423.294us |    2.039ms |           1
│││├── a_relu         |       38.631us |  38.631us |  286.720us |           1
│││├── b              |      149.448us | 523.513us |   11.881ms |           1
│││├── b_bn           |      215.828us | 502.518us |    2.113ms |           1
│││├── b_relu         |       39.882us |  39.882us |  287.744us |           1
│││├── c              |      146.487us | 514.820us |   11.861ms |           1
│││└── c_bn           |        1.277ms |   3.692ms |    8.246ms |           1
││└── relu            |       37.405us |  37.405us |    1.064ms |           1
│├── pathway0_res2    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      133.409us | 462.168us |   26.239ms |           1
│││├── a_bn           |      187.157us | 423.205us |    2.027ms |           1
│││├── a_relu         |       38.389us |  38.389us |  286.720us |           1
│││├── b              |      148.168us | 520.642us |   12.094ms |           1
│││├── b_bn           |      187.495us | 426.633us |    2.035ms |           1
│││├── b_relu         |       40.290us |  40.290us |  287.712us |           1
│││├── c              |        1.231ms |   4.856ms |   16.219ms |           1
│││└── c_bn           |        1.278ms |   3.690ms |    8.294ms |           1
││└── relu            |       37.612us |  37.612us |    1.063ms |           1
├── pathway0_pool     |        1.132ms |   2.251ms |    4.920ms |           1
├── s3                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |      152.350us | 537.736us |    7.606ms |           1
││├── branch1_bn      |      183.713us | 417.177us |    1.548ms |           1
││├── branch2         |                |           |            |            
│││├── a              |      861.450us |   3.375ms |   20.480ms |           1
│││├── a_bn           |      894.142us |   2.545ms |    3.763ms |           1
│││├── a_relu         |       39.342us |  39.342us |  287.744us |           1
│││├── b              |      132.649us | 459.417us |    7.992ms |           1
│││├── b_bn           |      187.976us | 426.150us |  706.528us |           1
│││├── b_relu         |       37.995us |  37.995us |   91.104us |           1
│││├── c              |      838.460us |   3.287ms |    7.455ms |           1
│││└── c_bn           |        1.542ms |   4.489ms |    5.595ms |           1
││└── relu            |       37.391us |  37.391us |  286.720us |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      143.577us | 505.112us |    3.537ms |           1
│││├── a_bn           |      184.938us | 419.264us |  701.376us |           1
│││├── a_relu         |       38.515us |  38.515us |   92.160us |           1
│││├── b              |      156.681us | 557.352us |    5.708ms |           1
│││├── b_bn           |      182.759us | 415.016us |  699.360us |           1
│││├── b_relu         |       38.618us |  38.618us |   92.160us |           1
│││├── c              |      128.359us | 445.824us |    4.564ms |           1
│││└── c_bn           |      185.381us | 421.187us |    1.535ms |           1
││└── relu            |       37.444us |  37.444us |  285.664us |           1
│├── pathway0_res2    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      154.071us | 547.283us |    8.159ms |           1
│││├── a_bn           |      181.715us | 411.650us |  691.136us |           1
│││├── a_relu         |       39.031us |  39.031us |   93.184us |           1
│││├── b              |      142.107us | 499.828us |    5.654ms |           1
│││├── b_bn           |      197.493us | 437.633us |  721.952us |           1
│││├── b_relu         |       38.053us |  38.053us |   92.128us |           1
│││├── c              |      129.444us | 448.229us |    4.645ms |           1
│││└── c_bn           |      893.866us |   2.549ms |    3.656ms |           1
││└── relu            |       37.347us |  37.347us |  286.720us |           1
│├── pathway0_res3    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      143.157us | 504.431us |    3.533ms |           1
│││├── a_bn           |      182.972us | 414.835us |  690.208us |           1
│││├── a_relu         |       38.658us |  38.658us |   92.160us |           1
│││├── b              |      141.193us | 496.578us |    5.655ms |           1
│││├── b_bn           |      181.736us | 413.179us |  692.256us |           1
│││├── b_relu         |       38.147us |  38.147us |   93.184us |           1
│││├── c              |      127.393us | 441.482us |    4.600ms |           1
│││└── c_bn           |      912.711us |   2.603ms |    3.722ms |           1
││└── relu            |       36.773us |  36.773us |  284.672us |           1
├── s4                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |      131.782us | 455.386us |    6.845ms |           1
││├── branch1_bn      |      185.469us | 417.527us |  980.032us |           1
││├── branch2         |                |           |            |            
│││├── a              |      141.846us | 496.699us |   14.805ms |           1
│││├── a_bn           |      182.725us | 415.339us |  968.768us |           1
│││├── a_relu         |       39.446us |  39.446us |  157.664us |           1
│││├── b              |      127.418us | 442.812us |    8.877ms |           1
│││├── b_bn           |      192.609us | 443.162us |  521.312us |           1
│││├── b_relu         |       38.042us |  38.042us |   58.336us |           1
│││├── c              |      129.775us | 449.551us |    3.945ms |           1
│││└── c_bn           |      183.294us | 416.695us |  978.944us |           1
││└── relu            |       35.801us |  35.801us |  154.592us |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      129.795us | 451.165us |    4.433ms |           1
│││├── a_bn           |      185.121us | 416.821us |  518.208us |           1
│││├── a_relu         |       38.715us |  38.715us |   59.392us |           1
│││├── b              |      130.349us | 450.002us |    8.825ms |           1
│││├── b_bn           |      183.171us | 415.752us |  519.232us |           1
│││├── b_relu         |       39.036us |  39.036us |   60.384us |           1
│││├── c              |      129.208us | 446.712us |    3.953ms |           1
│││└── c_bn           |      183.731us | 418.392us |  980.032us |           1
││└── relu            |       34.864us |  34.864us |  154.624us |           1
│├── pathway0_res2    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      143.078us | 502.430us |    7.690ms |           1
│││├── a_bn           |      180.345us | 409.051us |  514.048us |           1
│││├── a_relu         |       38.651us |  38.651us |   59.360us |           1
│││├── b              |      128.370us | 447.045us |    8.826ms |           1
│││├── b_bn           |      180.655us | 409.644us |  513.984us |           1
│││├── b_relu         |       37.411us |  37.411us |   58.368us |           1
│││├── c              |      143.195us | 471.031us |    3.933ms |           1
│││└── c_bn           |        1.346ms |   3.902ms |    4.457ms |           1
││└── relu            |       37.326us |  37.326us |  156.672us |           1
│├── pathway0_res3    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      132.286us | 456.118us |    4.102ms |           1
│││├── a_bn           |      200.738us | 449.657us |  548.864us |           1
│││├── a_relu         |       44.710us |  44.710us |   65.536us |           1
│││├── b              |      140.026us | 489.908us |    8.136ms |           1
│││├── b_bn           |      183.358us | 416.435us |  523.264us |           1
│││├── b_relu         |       38.429us |  38.429us |   59.392us |           1
│││├── c              |      127.416us | 440.861us |    3.669ms |           1
│││└── c_bn           |        2.059ms |   6.046ms |    6.599ms |           1
││└── relu            |       38.267us |  38.267us |  157.696us |           1
│├── pathway0_res4    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      150.138us | 529.332us |    7.103ms |           1
│││├── a_bn           |      192.388us | 421.879us |  521.216us |           1
│││├── a_relu         |       38.302us |  38.302us |   57.344us |           1
│││├── b              |      129.851us | 450.353us |    8.123ms |           1
│││├── b_bn           |      180.518us | 409.510us |  513.024us |           1
│││├── b_relu         |       38.823us |  38.823us |   58.368us |           1
│││├── c              |      130.155us | 449.574us |    3.657ms |           1
│││└── c_bn           |      840.423us |   2.387ms |    2.936ms |           1
││└── relu            |       37.912us |  37.912us |  157.696us |           1
│├── pathway0_res5    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      135.028us | 468.453us |    4.134ms |           1
│││├── a_bn           |      184.874us | 420.543us |  521.216us |           1
│││├── a_relu         |       38.565us |  38.565us |   59.392us |           1
│││├── b              |      131.549us | 457.162us |    8.096ms |           1
│││├── b_bn           |      182.685us | 413.173us |  514.048us |           1
│││├── b_relu         |       38.619us |  38.619us |   58.368us |           1
│││├── c              |      126.629us | 439.400us |    3.705ms |           1
│││└── c_bn           |        1.351ms |   3.918ms |    4.481ms |           1
││└── relu            |       36.344us |  36.344us |  155.648us |           1
├── s5                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |      145.793us | 513.654us |    5.706ms |           1
││├── branch1_bn      |      188.475us | 432.788us |  637.952us |           1
││├── branch2         |                |           |            |            
│││├── a              |      140.460us | 491.719us |    6.938ms |           1
│││├── a_bn           |      802.731us |   2.275ms |    2.519ms |           1
│││├── a_relu         |       39.343us |  39.343us |   93.184us |           1
│││├── b              |      129.868us | 450.025us |    9.553ms |           1
│││├── b_bn           |      180.469us | 410.554us |  429.056us |           1
│││├── b_relu         |       38.875us |  38.875us |   41.984us |           1
│││├── c              |      804.685us |   3.149ms |    5.926ms |           1
│││└── c_bn           |        1.054ms |   3.029ms |    3.227ms |           1
││└── relu            |       37.817us |  37.817us |   92.160us |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      131.240us | 455.182us |   12.563ms |           1
│││├── a_bn           |      182.044us | 414.675us |  435.200us |           1
│││├── a_relu         |       38.988us |  38.988us |   40.960us |           1
│││├── b              |      129.792us | 452.412us |    9.483ms |           1
│││├── b_bn           |      181.906us | 413.540us |  435.200us |           1
│││├── b_relu         |       39.071us |  39.071us |   43.008us |           1
│││├── c              |      140.666us | 493.548us |    3.297ms |           1
│││└── c_bn           |      182.648us | 415.165us |  621.568us |           1
││└── relu            |       37.201us |  37.201us |   92.160us |           1
│├── pathway0_res2    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      128.349us | 445.061us |    4.591ms |           1
│││├── a_bn           |      178.598us | 403.676us |  420.864us |           1
│││├── a_relu         |       37.611us |  37.611us |   41.984us |           1
│││├── b              |      128.204us | 444.641us |    9.458ms |           1
│││├── b_bn           |      179.573us | 407.098us |  427.008us |           1
│││├── b_relu         |       39.050us |  39.050us |   43.008us |           1
│││├── c              |      141.366us | 496.434us |    3.295ms |           1
│││└── c_bn           |      802.537us |   2.273ms |    2.456ms |           1
││└── relu            |       37.260us |  37.260us |   91.136us |           1
└── head              |                |           |            |            
 ├── pathway0_avgpool |       67.693us |  67.693us |  961.536us |           1
 ├── dropout          |       71.013us | 127.499us |  131.072us |           1
 ├── projection       |      250.353us | 399.099us |  410.624us |           1
 └── act              |        0.000us |   0.000us |    0.000us |           0
```