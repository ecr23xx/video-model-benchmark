Profile model x3d_bottleneck

Model info: SimpleNet(
  (s1): ResStage(
    (pathway0_res0): ResBlock(
      (branch1): Conv3d(3, 16, kernel_size=(1, 1, 1), stride=[1, 1, 1], bias=False)
      (branch1_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (branch2): X3DBottleneckTransform(
        (a): Conv3d(3, 16, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(16, 16, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], groups=16, bias=False)
        (b_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(16, 16, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res1): ResBlock(
      (branch2): X3DBottleneckTransform(
        (a): Conv3d(16, 16, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(16, 16, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], groups=16, bias=False)
        (b_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(16, 16, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
  )
  (s2): ResStage(
    (pathway0_res0): ResBlock(
      (branch1): Conv3d(16, 64, kernel_size=(1, 1, 1), stride=[1, 2, 2], bias=False)
      (branch1_bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (branch2): X3DBottleneckTransform(
        (a): Conv3d(16, 16, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(16, 16, kernel_size=[3, 3, 3], stride=[1, 2, 2], padding=[1, 1, 1], dilation=[1, 1, 1], groups=16, bias=False)
        (b_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(16, 64, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res1): ResBlock(
      (branch2): X3DBottleneckTransform(
        (a): Conv3d(64, 16, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(16, 16, kernel_size=[3, 3, 3], stride=[1, 1, 1], padding=[1, 1, 1], dilation=[1, 1, 1], groups=16, bias=False)
        (b_bn): BatchNorm3d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(16, 64, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
  )
  (head): ResNetBasicHead(
    (pathway0_avgpool): AvgPool3d(kernel_size=16, stride=1, padding=0)
    (projection): Linear(in_features=64, out_features=400, bias=True)
    (act): Softmax(dim=4)
  )
)

Params: 33,680
GPU Mem: 0.0001583099365234375 MB
FLOPs: 2.5883043839999997 GFLOPs

Forward pass
Module                | Self CPU total | CPU total | CUDA total | Occurrences
----------------------|----------------|-----------|------------|------------
SimpleNet             |                |           |            |            
├── s1                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |      626.448us |   2.426ms |    5.361ms |           1
││├── branch1_bn      |      484.084us |   1.318ms |   18.244ms |           1
││├── branch2         |                |           |            |            
│││├── a              |      415.685us |   1.610ms |    4.584ms |           1
│││├── a_bn           |      445.967us |   1.239ms |   18.190ms |           1
│││├── a_relu         |       34.805us |  34.805us |  780.288us |           1
│││├── b              |      618.769us |   2.423ms |   90.126ms |           1
│││├── b_bn           |      438.847us |   1.222ms |   18.147ms |           1
│││├── b_relu         |       29.097us |  29.097us |  774.144us |           1
│││├── c              |      437.484us |   1.700ms |    5.712ms |           1
│││└── c_bn           |      448.162us |   1.247ms |   17.901ms |           1
││└── relu            |       26.464us |  26.464us |  785.568us |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       89.141us | 305.820us |    3.469ms |           1
│││├── a_bn           |      446.128us |   1.246ms |   15.245ms |           1
│││├── a_relu         |       29.567us |  29.567us |  786.432us |           1
│││├── b              |      599.718us |   2.328ms |   66.224ms |           1
│││├── b_bn           |      438.551us |   1.221ms |   14.977ms |           1
│││├── b_relu         |       28.670us |  28.670us |  787.424us |           1
│││├── c              |      435.568us |   1.689ms |    4.849ms |           1
│││└── c_bn           |      439.014us |   1.220ms |   15.110ms |           1
││└── relu            |       27.044us |  27.044us |  785.216us |           1
├── s2                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |      388.753us |   1.503ms |    4.977ms |           1
││├── branch1_bn      |      437.180us |   1.216ms |    5.397ms |           1
││├── branch2         |                |           |            |            
│││├── a              |      394.380us |   1.526ms |    4.693ms |           1
│││├── a_bn           |      434.909us |   1.211ms |   15.155ms |           1
│││├── a_relu         |       28.016us |  28.016us |  786.720us |           1
│││├── b              |      275.834us |   1.054ms |   16.874ms |           1
│││├── b_bn           |      124.322us | 279.785us |    3.673ms |           1
│││├── b_relu         |       27.604us |  27.604us |  211.072us |           1
│││├── c              |      464.935us |   1.809ms |    6.576ms |           1
│││└── c_bn           |      445.870us |   1.243ms |    5.383ms |           1
││└── relu            |       26.234us |  26.234us |  787.264us |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       97.885us | 342.520us |    3.430ms |           1
│││├── a_bn           |      125.179us | 281.821us |    3.712ms |           1
│││├── a_relu         |       27.422us |  27.422us |  210.912us |           1
│││├── b              |      318.281us |   1.221ms |   16.334ms |           1
│││├── b_bn           |      125.396us | 281.754us |    3.703ms |           1
│││├── b_relu         |       27.862us |  27.862us |  211.264us |           1
│││├── c              |      410.354us |   1.592ms |    6.442ms |           1
│││└── c_bn           |      436.114us |   1.215ms |    5.354ms |           1
││└── relu            |       26.277us |  26.277us |  787.424us |           1
└── head              |                |           |            |            
 ├── pathway0_avgpool |       48.786us |  48.786us |    8.511ms |           1
 ├── projection       |      396.342us | 745.319us |    1.338ms |           1
 └── act              |        0.000us |   0.000us |    0.000us |           0


-----------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  
Name                                 Self CPU total %  Self CPU total   CPU total %      CPU total        CPU time avg     CUDA total %     CUDA total       CUDA time avg    Number of Calls  
-----------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  
CudnnConvolutionBackward             0.23%            43.607ms         0.58%            110.129ms        786.632us        44.28%           20.007s          142.905ms        140              
cudnn_convolution_backward           0.35%            66.521ms         0.35%            66.521ms         475.151us        44.28%           20.006s          142.901ms        140              
conv3d                               0.01%            1.110ms          0.14%            26.170ms         186.932us        1.10%            496.466ms        3.546ms          140              
convolution                          0.01%            1.016ms          0.13%            25.061ms         179.007us        1.10%            495.982ms        3.543ms          140              
_convolution                         0.01%            2.322ms          0.13%            24.045ms         171.752us        1.10%            495.544ms        3.540ms          140              
cudnn_convolution                    0.11%            21.165ms         0.11%            21.165ms         151.179us        1.09%            494.442ms        3.532ms          140              
batch_norm                           0.01%            1.154ms          0.67%            128.466ms        917.615us        1.04%            471.201ms        3.366ms          140              
_batch_norm_impl_index               0.02%            3.438ms          0.67%            127.312ms        909.370us        1.04%            470.799ms        3.363ms          140              
cudnn_batch_norm                     0.64%            121.798ms        0.64%            121.798ms        869.985us        1.04%            468.244ms        3.345ms          140              
CudnnBatchNormBackward               0.07%            13.190ms         0.20%            37.423ms         267.310us        1.03%            467.196ms        3.337ms          140              
cudnn_batch_norm_backward            0.12%            23.261ms         0.12%            23.261ms         166.151us        1.03%            466.365ms        3.331ms          140              
AvgPool3DBackward                    0.00%            221.048us        0.01%            1.863ms          186.258us        0.25%            114.779ms        11.478ms         10               
avg_pool3d_backward                  0.01%            1.642ms          0.01%            1.642ms          164.154us        0.25%            114.747ms        11.475ms         10               
ReluBackward1                        0.01%            2.649ms          0.30%            57.182ms         476.520us        0.25%            110.772ms        923.099us        120              
threshold_backward                   0.29%            54.533ms         0.29%            54.533ms         454.441us        0.24%            110.421ms        920.172us        120              
avg_pool3d                           0.00%            671.210us        0.00%            671.210us        67.121us         0.19%            85.632ms         8.563ms          10               
add                                  0.03%            6.373ms          0.03%            6.373ms          30.348us         0.18%            80.356ms         382.650us        210              
relu_                                0.02%            2.949ms          0.02%            2.949ms          24.579us         0.17%            76.190ms         634.913us        120              
to                                   97.66%           18.647s          97.66%           18.647s          932.348ms        0.10%            42.957ms         2.148ms          20               
log_softmax                          0.00%            143.817us        0.00%            482.431us        48.243us         0.05%            23.502ms         2.350ms          10               
_log_softmax                         0.00%            338.614us        0.00%            338.614us        33.861us         0.05%            23.465ms         2.347ms          10               
LogSoftmaxBackward                   0.00%            321.360us        0.00%            854.568us        85.457us         0.03%            14.818ms         1.482ms          10               
_log_softmax_backward_data           0.00%            533.208us        0.00%            533.208us        53.321us         0.03%            14.770ms         1.477ms          10               
mm                                   0.02%            3.827ms          0.02%            3.827ms          127.580us        0.02%            8.316ms          277.214us        30               
MmBackward                           0.00%            644.883us        0.02%            4.256ms          425.601us        0.01%            6.239ms          623.855us        10               
add_                                 0.06%            12.266ms         0.06%            12.266ms         30.212us         0.01%            5.027ms          12.383us         406              
torch::autograd::AccumulateGrad      0.25%            47.780ms         0.31%            60.010ms         136.386us        0.01%            4.069ms          9.248us          440              
matmul                               0.00%            276.568us        0.01%            1.841ms          184.149us        0.01%            2.905ms          290.469us        10               
contiguous                           0.02%            3.979ms          0.02%            4.266ms          4.309us          0.00%            2.045ms          2.066us          990              
NllLossBackward                      0.00%            543.997us        0.01%            1.496ms          149.622us        0.00%            1.422ms          142.217us        10               
nll_loss_backward                    0.00%            952.227us        0.00%            952.227us        95.223us         0.00%            1.316ms          131.569us        10               
sum                                  0.00%            895.583us        0.00%            895.583us        89.558us         0.00%            1.272ms          127.213us        10               
cat                                  0.00%            587.590us        0.00%            587.590us        58.759us         0.00%            482.125us        48.212us         10               
ViewBackward                         0.00%            314.930us        0.01%            1.130ms          56.502us         0.00%            141.141us        7.057us          20               
reshape                              0.00%            463.172us        0.01%            1.163ms          38.758us         0.00%            118.781us        3.959us          30               
nll_loss                             0.00%            128.149us        0.00%            621.568us        62.157us         0.00%            112.891us        11.289us         10               
unsigned short                       0.00%            755.463us        0.00%            755.463us        15.109us         0.00%            82.656us         1.653us          50               
view                                 0.01%            1.209ms          0.01%            1.209ms          20.151us         0.00%            80.125us         1.335us          60               
CatBackward                          0.00%            168.695us        0.00%            513.807us        51.381us         0.00%            73.641us         7.364us          10               
nll_loss_forward                     0.00%            493.419us        0.00%            493.419us        49.342us         0.00%            72.750us         7.275us          10               
AddBackward0                         0.00%            373.744us        0.00%            373.744us        7.475us          0.00%            69.078us         1.382us          50               
UnsafeViewBackward                   0.00%            146.782us        0.00%            494.409us        49.441us         0.00%            65.562us         6.556us          10               
detach                               0.00%            241.973us        0.00%            241.973us        5.499us          0.00%            64.141us         1.458us          44               
narrow                               0.00%            198.791us        0.00%            345.112us        34.511us         0.00%            48.750us         4.875us          10               
empty                                0.00%            372.367us        0.00%            372.367us        18.618us         0.00%            43.492us         2.175us          20               
torch::autograd::CopyBackwards       0.00%            166.444us        0.00%            242.826us        24.283us         0.00%            41.500us         4.150us          10               
TBackward                            0.00%            126.463us        0.00%            298.586us        29.859us         0.00%            40.969us         4.097us          10               
empty_like                           0.00%            68.787us         0.00%            286.132us        28.613us         0.00%            40.531us         4.053us          10               
PermuteBackward                      0.00%            161.860us        0.00%            348.269us        34.827us         0.00%            39.719us         3.972us          10               
permute                              0.00%            327.981us        0.00%            327.981us        16.399us         0.00%            28.188us         1.409us          20               
slice                                0.00%            146.321us        0.00%            146.321us        14.632us         0.00%            23.922us         2.392us          10               
torch::autograd::GraphRoot           0.00%            205.327us        0.00%            205.327us        20.533us         0.00%            22.359us         2.236us          10               
_unsafe_view                         0.00%            109.877us        0.00%            109.877us        10.988us         0.00%            13.125us         1.312us          10               
-----------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  
Self CPU time total: 19.094s
CUDA time total: 45.186s

