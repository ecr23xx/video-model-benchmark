Profile model i3d

Model info: ResNet(
  (s1): VideoModelStem(
    (pathway0_stem): ResNetBasicStem(
      (conv): Conv3d(3, 64, kernel_size=[5, 7, 7], stride=[1, 2, 2], padding=[2, 3, 3], bias=False)
      (bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (relu): ReLU(inplace=True)
      (pool_layer): MaxPool3d(kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=1, ceil_mode=False)
    )
  )
  (s2): ResStage(
    (pathway0_res0): ResBlock(
      (branch1): Conv3d(64, 256, kernel_size=(1, 1, 1), stride=[1, 1, 1], bias=False)
      (branch1_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (branch2): BottleneckTransform(
        (a): Conv3d(64, 64, kernel_size=[3, 1, 1], stride=[1, 1, 1], padding=[1, 0, 0], bias=False)
        (a_bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(64, 64, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(64, 256, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res1): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(256, 64, kernel_size=[3, 1, 1], stride=[1, 1, 1], padding=[1, 0, 0], bias=False)
        (a_bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(64, 64, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(64, 256, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res2): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(256, 64, kernel_size=[3, 1, 1], stride=[1, 1, 1], padding=[1, 0, 0], bias=False)
        (a_bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(64, 64, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(64, 256, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
  )
  (pathway0_pool): MaxPool3d(kernel_size=[2, 1, 1], stride=[2, 1, 1], padding=[0, 0, 0], dilation=1, ceil_mode=False)
  (s3): ResStage(
    (pathway0_res0): ResBlock(
      (branch1): Conv3d(256, 512, kernel_size=(1, 1, 1), stride=[1, 2, 2], bias=False)
      (branch1_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (branch2): BottleneckTransform(
        (a): Conv3d(256, 128, kernel_size=[3, 1, 1], stride=[1, 1, 1], padding=[1, 0, 0], bias=False)
        (a_bn): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(128, 128, kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(128, 512, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res1): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(512, 128, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(128, 128, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(128, 512, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res2): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(512, 128, kernel_size=[3, 1, 1], stride=[1, 1, 1], padding=[1, 0, 0], bias=False)
        (a_bn): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(128, 128, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(128, 512, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res3): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(512, 128, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(128, 128, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(128, 512, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
  )
  (s4): ResStage(
    (pathway0_res0): ResBlock(
      (branch1): Conv3d(512, 1024, kernel_size=(1, 1, 1), stride=[1, 2, 2], bias=False)
      (branch1_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (branch2): BottleneckTransform(
        (a): Conv3d(512, 256, kernel_size=[3, 1, 1], stride=[1, 1, 1], padding=[1, 0, 0], bias=False)
        (a_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(256, 256, kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(256, 1024, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res1): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(1024, 256, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(256, 256, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(256, 1024, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res2): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(1024, 256, kernel_size=[3, 1, 1], stride=[1, 1, 1], padding=[1, 0, 0], bias=False)
        (a_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(256, 256, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(256, 1024, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res3): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(1024, 256, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(256, 256, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(256, 1024, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res4): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(1024, 256, kernel_size=[3, 1, 1], stride=[1, 1, 1], padding=[1, 0, 0], bias=False)
        (a_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(256, 256, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(256, 1024, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res5): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(1024, 256, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(256, 256, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(256, 1024, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
  )
  (s5): ResStage(
    (pathway0_res0): ResBlock(
      (branch1): Conv3d(1024, 2048, kernel_size=(1, 1, 1), stride=[1, 2, 2], bias=False)
      (branch1_bn): BatchNorm3d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (branch2): BottleneckTransform(
        (a): Conv3d(1024, 512, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(512, 512, kernel_size=[1, 3, 3], stride=[1, 2, 2], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(512, 2048, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res1): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(2048, 512, kernel_size=[3, 1, 1], stride=[1, 1, 1], padding=[1, 0, 0], bias=False)
        (a_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(512, 512, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(512, 2048, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
    (pathway0_res2): ResBlock(
      (branch2): BottleneckTransform(
        (a): Conv3d(2048, 512, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (a_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (a_relu): ReLU(inplace=True)
        (b): Conv3d(512, 512, kernel_size=[1, 3, 3], stride=[1, 1, 1], padding=[0, 1, 1], dilation=[1, 1, 1], bias=False)
        (b_bn): BatchNorm3d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (b_relu): ReLU(inplace=True)
        (c): Conv3d(512, 2048, kernel_size=[1, 1, 1], stride=[1, 1, 1], padding=[0, 0, 0], bias=False)
        (c_bn): BatchNorm3d(2048, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      )
      (relu): ReLU(inplace=True)
    )
  )
  (head): ResNetBasicHead(
    (pathway0_avgpool): AvgPool3d(kernel_size=[4, 7, 7], stride=1, padding=0)
    (dropout): Dropout(p=0.5, inplace=False)
    (projection): Linear(in_features=2048, out_features=400, bias=True)
    (act): Softmax(dim=4)
  )
)

Params: 28,043,472
GPU Mem: 0.10470056533813477 MB
FLOPs: 56.814501888 GFLOPs

Forward pass
Module                | Self CPU total | CPU total | CUDA total | Occurrences
----------------------|----------------|-----------|------------|------------
ResNet                |                |           |            |            
├── s1                |                |           |            |            
│├── pathway0_stem    |                |           |            |            
││├── conv            |      579.702us |   2.242ms |   65.238ms |           1
││├── bn              |      510.624us |   1.389ms |    6.160ms |           1
││├── relu            |       48.929us |  48.929us |  791.744us |           1
││└── pool_layer      |      529.703us |   1.047ms |    2.383ms |           1
├── s2                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |      424.485us |   1.638ms |    7.033ms |           1
││├── branch1_bn      |      495.261us |   1.377ms |    4.938ms |           1
││├── branch2         |                |           |            |            
│││├── a              |      300.889us |   1.144ms |    5.276ms |           1
│││├── a_bn           |      337.350us | 904.928us |    2.082ms |           1
│││├── a_relu         |       31.336us |  31.336us |  210.272us |           1
│││├── b              |      287.591us |   1.093ms |   13.286ms |           1
│││├── b_bn           |      328.104us | 877.631us |    2.068ms |           1
│││├── b_relu         |       29.728us |  29.728us |  209.152us |           1
│││├── c              |      439.794us |   1.702ms |    7.132ms |           1
│││└── c_bn           |      467.714us |   1.285ms |    4.840ms |           1
││└── relu            |       27.947us |  27.947us |  773.440us |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      114.643us | 406.187us |    9.420ms |           1
│││├── a_bn           |      134.486us | 302.959us |    1.498ms |           1
│││├── a_relu         |       28.944us |  28.944us |  208.928us |           1
│││├── b              |       93.993us | 323.589us |   12.525ms |           1
│││├── b_bn           |      160.970us | 378.779us |    1.566ms |           1
│││├── b_relu         |       29.462us |  29.462us |  209.152us |           1
│││├── c              |      407.916us |   1.578ms |    6.948ms |           1
│││└── c_bn           |      449.918us |   1.249ms |    4.800ms |           1
││└── relu            |       29.243us |  29.243us |  774.048us |           1
│├── pathway0_res2    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      104.654us | 367.251us |    9.381ms |           1
│││├── a_bn           |      136.840us | 307.523us |    1.500ms |           1
│││├── a_relu         |       30.605us |  30.605us |  208.896us |           1
│││├── b              |      293.242us |   1.118ms |   13.325ms |           1
│││├── b_bn           |      327.842us | 880.686us |    2.074ms |           1
│││├── b_relu         |       28.991us |  28.991us |  208.800us |           1
│││├── c              |      423.958us |   1.642ms |    7.094ms |           1
│││└── c_bn           |      475.204us |   1.323ms |    4.870ms |           1
││└── relu            |       27.946us |  27.946us |  773.216us |           1
├── pathway0_pool     |      632.760us |   1.256ms |    3.207ms |           1
├── s3                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |      114.520us | 406.320us |    3.870ms |           1
││├── branch1_bn      |      329.847us | 885.869us |    1.764ms |           1
││├── branch2         |                |           |            |            
│││├── a              |      306.928us |   1.175ms |    9.243ms |           1
│││├── a_bn           |      339.464us | 915.490us |    1.781ms |           1
│││├── a_relu         |       28.837us |  28.837us |  208.896us |           1
│││├── b              |      102.289us | 358.362us |    3.154ms |           1
│││├── b_bn           |      128.800us | 289.926us |  490.752us |           1
│││├── b_relu         |       29.181us |  29.181us |   67.488us |           1
│││├── c              |      318.553us |   1.223ms |    3.391ms |           1
│││└── c_bn           |      325.525us | 878.096us |    1.756ms |           1
││└── relu            |       27.624us |  27.624us |  207.936us |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       96.704us | 333.962us |    2.278ms |           1
│││├── a_bn           |      136.415us | 308.106us |  505.472us |           1
│││├── a_relu         |       29.141us |  29.141us |   66.464us |           1
│││├── b              |       93.849us | 324.477us |    4.558ms |           1
│││├── b_bn           |      132.133us | 296.650us |  494.496us |           1
│││├── b_relu         |       27.998us |  27.998us |   66.592us |           1
│││├── c              |      319.658us |   1.227ms |    3.400ms |           1
│││└── c_bn           |      325.408us | 875.318us |    1.754ms |           1
││└── relu            |       27.625us |  27.625us |  208.896us |           1
│├── pathway0_res2    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      100.873us | 351.082us |    4.208ms |           1
│││├── a_bn           |      153.526us | 359.611us |  552.512us |           1
│││├── a_relu         |       29.325us |  29.325us |   67.584us |           1
│││├── b              |       93.928us | 323.503us |    4.561ms |           1
│││├── b_bn           |      129.823us | 290.996us |  491.776us |           1
│││├── b_relu         |       28.868us |  28.868us |   67.008us |           1
│││├── c              |      295.541us |   1.132ms |    3.315ms |           1
│││└── c_bn           |      361.883us | 944.779us |    1.828ms |           1
││└── relu            |       28.005us |  28.005us |  209.920us |           1
│├── pathway0_res3    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |      101.597us | 347.793us |    2.310ms |           1
│││├── a_bn           |      302.420us | 783.520us |  987.008us |           1
│││├── a_relu         |       29.413us |  29.413us |   67.040us |           1
│││├── b              |      232.932us | 879.847us |    5.102ms |           1
│││├── b_bn           |      290.560us | 767.833us |  958.720us |           1
│││├── b_relu         |       29.400us |  29.400us |   66.944us |           1
│││├── c              |      297.507us |   1.139ms |    3.302ms |           1
│││└── c_bn           |      327.669us | 883.039us |    1.763ms |           1
││└── relu            |       38.857us |  38.857us |  219.136us |           1
├── s4                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |      257.671us | 980.777us |    4.109ms |           1
││├── branch1_bn      |      294.404us | 782.211us |    1.078ms |           1
││├── branch2         |                |           |            |            
│││├── a              |      257.725us | 982.249us |    8.683ms |           1
│││├── a_bn           |      300.393us | 781.376us |    1.200ms |           1
│││├── a_relu         |       28.413us |  28.413us |  114.688us |           1
│││├── b              |       99.226us | 348.192us |    3.956ms |           1
│││├── b_bn           |      132.138us | 297.986us |  340.480us |           1
│││├── b_relu         |       28.526us |  28.526us |   40.704us |           1
│││├── c              |      272.411us |   1.037ms |    2.623ms |           1
│││└── c_bn           |      291.978us | 776.569us |    1.072ms |           1
││└── relu            |       27.600us |  27.600us |  114.560us |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       94.773us | 328.280us |    2.693ms |           1
│││├── a_bn           |      131.498us | 296.683us |  338.528us |           1
│││├── a_relu         |       28.453us |  28.453us |   40.960us |           1
│││├── b              |       96.194us | 333.469us |    5.392ms |           1
│││├── b_bn           |      131.252us | 296.088us |  337.536us |           1
│││├── b_relu         |       29.054us |  29.054us |   40.960us |           1
│││├── c              |      101.672us | 354.191us |    1.951ms |           1
│││└── c_bn           |      306.186us | 816.596us |    1.116ms |           1
││└── relu            |       28.031us |  28.031us |  114.688us |           1
│├── pathway0_res2    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       94.615us | 327.859us |    7.107ms |           1
│││├── a_bn           |      129.722us | 291.443us |  335.264us |           1
│││├── a_relu         |       29.770us |  29.770us |   41.248us |           1
│││├── b              |      114.438us | 365.617us |    5.395ms |           1
│││├── b_bn           |      129.071us | 291.084us |  331.264us |           1
│││├── b_relu         |       28.163us |  28.163us |   40.608us |           1
│││├── c              |      262.979us | 999.514us |    2.589ms |           1
│││└── c_bn           |      292.311us | 778.367us |    1.071ms |           1
││└── relu            |       27.900us |  27.900us |  114.720us |           1
│├── pathway0_res3    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       93.179us | 320.991us |    2.682ms |           1
│││├── a_bn           |      329.532us | 885.806us |  891.488us |           1
│││├── a_relu         |       28.524us |  28.524us |   40.960us |           1
│││├── b              |       93.844us | 323.302us |    5.378ms |           1
│││├── b_bn           |      131.319us | 296.577us |  357.728us |           1
│││├── b_relu         |       39.814us |  39.814us |   51.904us |           1
│││├── c              |      291.891us |   1.116ms |    2.704ms |           1
│││└── c_bn           |      294.287us | 782.764us |    1.083ms |           1
││└── relu            |       27.764us |  27.764us |  114.624us |           1
│├── pathway0_res4    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       90.587us | 312.834us |    7.102ms |           1
│││├── a_bn           |      332.480us | 871.393us |  908.160us |           1
│││├── a_relu         |       29.373us |  29.373us |   40.992us |           1
│││├── b              |       95.602us | 331.506us |    5.382ms |           1
│││├── b_bn           |      141.676us | 327.725us |  374.784us |           1
│││├── b_relu         |       28.612us |  28.612us |   40.960us |           1
│││├── c              |      301.306us |   1.153ms |    2.745ms |           1
│││└── c_bn           |      306.451us | 822.440us |    1.118ms |           1
││└── relu            |       27.597us |  27.597us |  114.464us |           1
│├── pathway0_res5    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       94.898us | 326.472us |    2.697ms |           1
│││├── a_bn           |      338.361us | 896.084us |  937.792us |           1
│││├── a_relu         |       29.183us |  29.183us |   41.024us |           1
│││├── b              |       92.456us | 318.921us |    5.371ms |           1
│││├── b_bn           |      129.876us | 291.376us |  337.984us |           1
│││├── b_relu         |       28.276us |  28.276us |   40.960us |           1
│││├── c              |      277.840us |   1.062ms |    2.653ms |           1
│││└── c_bn           |      341.805us | 921.633us |    1.213ms |           1
││└── relu            |       27.783us |  27.783us |  114.688us |           1
├── s5                |                |           |            |            
│├── pathway0_res0    |                |           |            |            
││├── branch1         |      257.383us | 967.005us |    4.640ms |           1
││├── branch1_bn      |      278.218us | 735.100us |  900.928us |           1
││├── branch2         |                |           |            |            
│││├── a              |      241.963us | 916.072us |    3.433ms |           1
│││├── a_bn           |      280.240us | 741.904us |  874.048us |           1
│││├── a_relu         |       28.645us |  28.645us |   67.392us |           1
│││├── b              |       99.559us | 349.193us |    4.038ms |           1
│││├── b_bn           |      130.713us | 293.933us |  303.584us |           1
│││├── b_relu         |       28.101us |  28.101us |   28.960us |           1
│││├── c              |      245.012us | 929.862us |    2.719ms |           1
│││└── c_bn           |      274.739us | 726.362us |  898.432us |           1
││└── relu            |       27.867us |  27.867us |   67.584us |           1
│├── pathway0_res1    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       95.243us | 328.983us |    8.961ms |           1
│││├── a_bn           |      154.061us | 350.987us |  364.928us |           1
│││├── a_relu         |       28.830us |  28.830us |   29.632us |           1
│││├── b              |       99.891us | 350.023us |    3.997ms |           1
│││├── b_bn           |      131.094us | 293.955us |  305.952us |           1
│││├── b_relu         |       29.486us |  29.486us |   30.720us |           1
│││├── c              |      244.825us | 929.556us |    2.721ms |           1
│││└── c_bn           |      284.344us | 739.067us |  906.528us |           1
││└── relu            |       27.635us |  27.635us |   67.488us |           1
│├── pathway0_res2    |                |           |            |            
││├── branch2         |                |           |            |            
│││├── a              |       97.721us | 338.961us |    3.302ms |           1
│││├── a_bn           |      129.794us | 292.210us |  308.608us |           1
│││├── a_relu         |       28.244us |  28.244us |   29.184us |           1
│││├── b              |      100.457us | 353.990us |    4.008ms |           1
│││├── b_bn           |      147.075us | 337.554us |  352.832us |           1
│││├── b_relu         |       29.349us |  29.349us |   30.336us |           1
│││├── c              |      250.243us | 949.370us |    2.732ms |           1
│││└── c_bn           |      291.944us | 771.604us |  945.888us |           1
││└── relu            |       27.945us |  27.945us |   67.424us |           1
└── head              |                |           |            |            
 ├── pathway0_avgpool |       67.779us |  67.779us |  621.472us |           1
 ├── dropout          |       56.908us | 101.644us |  101.632us |           1
 ├── projection       |      164.733us | 259.058us |  264.768us |           1
 └── act              |        0.000us |   0.000us |    0.000us |           0


Backward pass
Module                | Time Total
----------------------|-----------
ResNet                |           
├── s1                |           
│├── pathway0_stem    |           
││├── conv            |   99.182us
││├── bn              |   73.910us
││├── relu            |   46.015us
││└── pool_layer      |  117.779us
├── s2                |           
│├── pathway0_res0    |           
││├── branch1         |  155.687us
││├── branch1_bn      |   95.844us
││├── branch2         |           
│││├── a              |  178.814us
│││├── a_bn           |   79.155us
│││├── a_relu         |   52.452us
│││├── b              |  170.946us
│││├── b_bn           |   74.387us
│││├── b_relu         |   53.167us
│││├── c              |  153.542us
│││└── c_bn           |   87.261us
││└── relu            |   73.195us
│├── pathway0_res1    |           
││├── branch2         |           
│││├── a              |  150.204us
│││├── a_bn           |   73.910us
│││├── a_relu         |   52.452us
│││├── b              |  155.687us
│││├── b_bn           |   86.784us
│││├── b_relu         |   52.452us
│││├── c              |  150.442us
│││└── c_bn           |   77.486us
││└── relu            |   74.387us
│├── pathway0_res2    |           
││├── branch2         |           
│││├── a              |  152.588us
│││├── a_bn           |   73.671us
│││├── a_relu         |   51.737us
│││├── b              |  163.317us
│││├── b_bn           |   87.261us
│││├── b_relu         |   53.167us
│││├── c              |  164.747us
│││└── c_bn           |   75.579us
││└── relu            |   49.114us
├── pathway0_pool     |  157.833us
├── s3                |           
│├── pathway0_res0    |           
││├── branch1         |  154.257us
││├── branch1_bn      |   92.745us
││├── branch2         |           
│││├── a              |  150.681us
│││├── a_bn           |   76.532us
│││├── a_relu         |   51.498us
│││├── b              |  149.012us
│││├── b_bn           |   76.056us
│││├── b_relu         |   56.744us
│││├── c              |  159.502us
│││└── c_bn           |   76.056us
││└── relu            |   76.294us
│├── pathway0_res1    |           
││├── branch2         |           
│││├── a              |  155.210us
│││├── a_bn           |   76.056us
│││├── a_relu         |   53.883us
│││├── b              |  162.840us
│││├── b_bn           |   87.976us
│││├── b_relu         |   52.691us
│││├── c              |  160.217us
│││└── c_bn           |   76.532us
││└── relu            |   73.433us
│├── pathway0_res2    |           
││├── branch2         |           
│││├── a              |  157.118us
│││├── a_bn           |   74.863us
│││├── a_relu         |   53.167us
│││├── b              |  164.509us
│││├── b_bn           |   86.546us
│││├── b_relu         |   53.167us
│││├── c              |  156.879us
│││└── c_bn           |   76.532us
││└── relu            |   73.671us
│├── pathway0_res3    |           
││├── branch2         |           
│││├── a              |  154.734us
│││├── a_bn           |   87.738us
│││├── a_relu         |   52.929us
│││├── b              |  159.979us
│││├── b_bn           |   87.738us
│││├── b_relu         |   53.167us
│││├── c              |  151.873us
│││└── c_bn           |   77.009us
││└── relu            |   76.056us
├── s4                |           
│├── pathway0_res0    |           
││├── branch1         |  150.919us
││├── branch1_bn      |  103.474us
││├── branch2         |           
│││├── a              |  156.164us
│││├── a_bn           |   73.910us
│││├── a_relu         |   53.883us
│││├── b              |  153.065us
│││├── b_bn           |   82.970us
│││├── b_relu         |   50.783us
│││├── c              |  150.204us
│││└── c_bn           |   76.771us
││└── relu            |   76.532us
│├── pathway0_res1    |           
││├── branch2         |           
│││├── a              |  152.588us
│││├── a_bn           |   75.817us
│││├── a_relu         |   55.790us
│││├── b              |  173.092us
│││├── b_bn           |   73.195us
│││├── b_relu         |   50.545us
│││├── c              |  158.548us
│││└── c_bn           |   89.884us
││└── relu            |   75.102us
│├── pathway0_res2    |           
││├── branch2         |           
│││├── a              |  211.000us
│││├── a_bn           |   74.148us
│││├── a_relu         |   52.929us
│││├── b              |  164.270us
│││├── b_bn           |   75.579us
│││├── b_relu         |   52.452us
│││├── c              |  152.826us
│││└── c_bn           |   88.930us
││└── relu            |   75.579us
│├── pathway0_res3    |           
││├── branch2         |           
│││├── a              |  152.349us
│││├── a_bn           |   75.102us
│││├── a_relu         |   51.022us
│││├── b              |  159.740us
│││├── b_bn           |   84.162us
│││├── b_relu         |   66.519us
│││├── c              |  158.072us
│││└── c_bn           |   77.248us
││└── relu            |   73.195us
│├── pathway0_res4    |           
││├── branch2         |           
│││├── a              |  149.965us
│││├── a_bn           |   85.592us
│││├── a_relu         |   50.783us
│││├── b              |  168.562us
│││├── b_bn           |   71.764us
│││├── b_relu         |   50.545us
│││├── c              |  153.303us
│││└── c_bn           |   89.169us
││└── relu            |   75.102us
│├── pathway0_res5    |           
││├── branch2         |           
│││├── a              |  153.542us
│││├── a_bn           |   73.195us
│││├── a_relu         |   51.022us
│││├── b              |  167.131us
│││├── b_bn           |   73.433us
│││├── b_relu         |   51.260us
│││├── c              |  151.634us
│││└── c_bn           |   92.745us
││└── relu            |   75.340us
├── s5                |           
│├── pathway0_res0    |           
││├── branch1         |  177.622us
││├── branch1_bn      |   92.983us
││├── branch2         |           
│││├── a              |  151.396us
│││├── a_bn           |   81.062us
│││├── a_relu         |   56.267us
│││├── b              |  194.073us
│││├── b_bn           |   80.585us
│││├── b_relu         |   53.406us
│││├── c              |  153.303us
│││└── c_bn           |   85.592us
││└── relu            |   77.009us
│├── pathway0_res1    |           
││├── branch2         |           
│││├── a              |  171.185us
│││├── a_bn           |   76.056us
│││├── a_relu         |   52.214us
│││├── b              |  155.926us
│││├── b_bn           |   88.453us
│││├── b_relu         |   55.552us
│││├── c              |  156.403us
│││└── c_bn           |   79.155us
││└── relu            |   83.685us
│├── pathway0_res2    |           
││├── branch2         |           
│││├── a              |  167.847us
│││├── a_bn           |   91.553us
│││├── a_relu         |   54.359us
│││├── b              |  199.795us
│││├── b_bn           |   79.632us
│││├── b_relu         |   63.181us
│││├── c              |  382.185us
│││└── c_bn           |  825.644us
││└── relu            |   86.784us
└── head              |           
 ├── pathway0_avgpool |  273.705us
 ├── dropout          |   53.884ms
 ├── projection       |           
 └── act              |           


------------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  
Name                                  Self CPU total %  Self CPU total   CPU total %      CPU total        CPU time avg     CUDA total %     CUDA total       CUDA time avg    Number of Calls  
------------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  
CudnnConvolutionBackward              1.46%            42.648ms         6.68%            195.504ms        368.875us        30.00%           2.741s           5.172ms          530              
cudnn_convolution_backward            5.22%            152.856ms        5.22%            152.856ms        288.407us        29.99%           2.739s           5.169ms          530              
conv3d                                0.68%            19.889ms         2.80%            81.909ms         154.546us        6.34%            579.058ms        1.093ms          530              
convolution                           0.12%            3.607ms          2.12%            62.021ms         117.020us        6.32%            577.551ms        1.090ms          530              
_convolution                          0.84%            24.530ms         2.00%            58.414ms         110.214us        6.30%            575.984ms        1.087ms          530              
cudnn_convolution                     1.09%            31.931ms         1.09%            31.931ms         60.248us         6.27%            572.773ms        1.081ms          530              
CudnnBatchNormBackward                2.30%            67.233ms         4.22%            123.460ms        232.943us        2.15%            196.677ms        371.089us        530              
cudnn_batch_norm_backward             1.35%            39.621ms         1.35%            39.621ms         74.756us         2.12%            193.804ms        365.668us        530              
batch_norm                            0.95%            27.854ms         10.86%           317.845ms        599.707us        1.46%            133.013ms        250.968us        530              
_batch_norm_impl_index                3.26%            95.362ms         9.91%            289.991ms        547.152us        1.44%            131.519ms        248.149us        530              
cudnn_batch_norm                      3.39%            99.324ms         3.39%            99.324ms         187.403us        1.34%            122.622ms        231.362us        530              
add                                   2.57%            75.171ms         2.57%            75.171ms         88.436us         1.20%            109.799ms        129.175us        850              
ReluBackward1                         0.56%            16.454ms         1.03%            30.097ms         61.422us         1.09%            100.022ms        204.126us        490              
threshold_backward                    0.47%            13.643ms         0.47%            13.643ms         27.843us         1.08%            98.679ms         201.386us        490              
relu_                                 2.17%            63.634ms         2.17%            63.634ms         129.866us        0.74%            67.295ms         137.337us        490              
to                                    61.88%           1.811s           61.89%           1.811s           181.073ms        0.48%            44.227ms         4.423ms          10               
MaxPool3DWithIndicesBackward          0.01%            311.929us        0.28%            8.307ms          415.364us        0.40%            36.451ms         1.823ms          20               
max_pool3d_with_indices_backward      0.27%            7.995ms          0.27%            7.995ms          399.767us        0.40%            36.405ms         1.820ms          20               
max_pool3d                            0.01%            195.897us        0.04%            1.201ms          60.043us         0.18%            16.590ms         829.514us        20               
max_pool3d_with_indices               0.03%            1.005ms          0.03%            1.005ms          50.248us         0.18%            16.531ms         826.541us        20               
torch::autograd::AccumulateGrad       4.40%            128.683ms        6.65%            194.427ms        120.762us        0.16%            14.799ms         9.192us          1610             
add_                                  2.26%            66.033ms         2.26%            66.033ms         40.761us         0.11%            10.423ms         6.434us          1620             
avg_pool3d                            0.01%            410.603us        0.01%            410.603us        41.060us         0.06%            5.723ms          572.295us        10               
contiguous                            3.89%            113.895ms        3.89%            113.895ms        30.617us         0.06%            5.215ms          1.402us          3720             
AvgPool3DBackward                     0.01%            147.649us        0.05%            1.405ms          140.529us        0.04%            3.532ms          353.242us        10               
avg_pool3d_backward                   0.04%            1.258ms          0.04%            1.258ms          125.764us        0.04%            3.503ms          350.283us        10               
mm                                    0.05%            1.508ms          0.05%            1.508ms          50.276us         0.01%            488.688us        16.290us         30               
MmBackward                            0.02%            441.948us        0.06%            1.623ms          162.343us        0.00%            376.391us        37.639us         10               
matmul                                0.01%            256.894us        0.04%            1.159ms          115.899us        0.00%            344.875us        34.487us         10               
AddBackward0                          0.18%            5.331ms          0.18%            5.331ms          31.360us         0.00%            236.469us        1.391us          170              
ViewBackward                          0.01%            253.977us        0.03%            840.610us        42.031us         0.00%            146.516us        7.326us          20               
reshape                               0.06%            1.732ms          0.08%            2.240ms          74.669us         0.00%            131.516us        4.384us          30               
log_softmax                           0.00%            107.936us        0.01%            397.471us        39.747us         0.00%            92.312us         9.231us          10               
dropout                               0.00%            103.192us        0.02%            503.676us        50.368us         0.00%            84.891us         8.489us          10               
view                                  0.18%            5.391ms          0.18%            5.391ms          89.843us         0.00%            81.281us         1.355us          60               
LogSoftmaxBackward                    0.01%            270.680us        0.02%            621.591us        62.159us         0.00%            77.750us         7.775us          10               
NllLossBackward                       0.02%            441.137us        0.04%            1.197ms          119.668us        0.00%            75.703us         7.570us          10               
FusedDropoutBackward                  0.01%            156.073us        0.02%            615.564us        61.556us         0.00%            69.703us         6.970us          10               
CatBackward                           0.00%            121.453us        0.01%            343.145us        34.314us         0.00%            68.641us         6.864us          10               
UnsafeViewBackward                    0.00%            94.112us         0.06%            1.748ms          174.754us        0.00%            68.375us         6.838us          10               
unsigned short                        0.02%            579.616us        0.02%            579.616us        11.592us         0.00%            67.203us         1.344us          50               
nll_loss                              0.00%            90.772us         0.01%            422.391us        42.239us         0.00%            64.766us         6.477us          10               
_log_softmax                          0.01%            289.535us        0.01%            289.535us        28.954us         0.00%            64.750us         6.475us          10               
_fused_dropout                        0.01%            400.484us        0.01%            400.484us        40.048us         0.00%            58.312us         5.831us          10               
sum                                   0.01%            436.873us        0.01%            436.873us        43.687us         0.00%            54.328us         5.433us          10               
nll_loss_backward                     0.03%            755.543us        0.03%            755.543us        75.554us         0.00%            53.438us         5.344us          10               
_log_softmax_backward_data            0.01%            350.911us        0.01%            350.911us        35.091us         0.00%            48.109us         4.811us          10               
PermuteBackward                       0.00%            143.971us        0.01%            293.241us        29.324us         0.00%            43.609us         4.361us          10               
_masked_scale                         0.02%            459.491us        0.02%            459.491us        45.949us         0.00%            42.234us         4.223us          10               
narrow                                0.00%            108.523us        0.01%            221.692us        22.169us         0.00%            41.438us         4.144us          10               
TBackward                             0.00%            102.210us        0.01%            224.151us        22.415us         0.00%            40.719us         4.072us          10               
nll_loss_forward                      0.01%            331.619us        0.01%            331.619us        33.162us         0.00%            35.281us         3.528us          10               
cat                                   0.02%            506.860us        0.02%            506.860us        50.686us         0.00%            34.375us         3.438us          10               
empty                                 0.01%            180.460us        0.01%            180.460us        18.046us         0.00%            32.148us         3.215us          10               
permute                               0.01%            287.639us        0.01%            287.639us        14.382us         0.00%            30.969us         1.548us          20               
_unsafe_view                          0.00%            104.821us        0.00%            104.821us        10.482us         0.00%            15.797us         1.580us          10               
torch::autograd::GraphRoot            0.01%            203.016us        0.01%            203.016us        20.302us         0.00%            14.047us         1.405us          10               
slice                                 0.00%            113.169us        0.00%            113.169us        11.317us         0.00%            13.500us         1.350us          10               
------------------------------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  ---------------  
Self CPU time total: 2.926s
CUDA time total: 9.136s

